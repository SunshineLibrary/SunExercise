<!DOCTYPE html>
<html>
<head>
    <title>阳光提高班</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <!--<link href="js/libs/videojs/video-js.css" rel="stylesheet">-->
    <!--<script src="js/libs/videojs/video.js"></script>-->

    <script src="js/libs/jquery/jquery-1.9.1.js"></script>
    <link href="bootstrap/css/bootstrap.css" rel="stylesheet">
    <script src="js/libs/bootstrap/bootstrap.min.js"></script>
    <script src="js/libs/logger/Logger.js"></script>

    <link href="css/app.css" rel="stylesheet">
    <script src="js/libs/underscore/underscore.js"></script>
    <script src="js/libs/backbone/backbone.js"></script>
    <script src="js/libs/tv4/tv4.min.js"></script>

    <script src="js/sampledata.js"></script>

    <script src="js/utils.js"></script>
    <script src="js/views.js"></script>
    <script src="js/models.js"></script>
    <script src="js/sun.js"></script>
    <script src="js/app.js"></script>
</head>
<body>

<div class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <div class="nav-collapse collapse" id="header">
                loading header
            </div>
        </div>
    </div>
</div>
<div class="container" id="content_container">
    <div id="content">loading content</div>

</div>

<div class="navbar navbar-inverse navbar-fixed-bottom" style="display: none">
    <div class="navbar-inner">
        <div class="container">
            <div id="footer" class="pull-left" style="height:60px;margisn-top:15px">loading footer</div>
            <div style="text-align: right">
                <button class="btn" onclick="Sun.resetuserdata()">reset user data</button>
                <button class="btn" onclick="Sun.showuserdata()">show user data</button>
            </div>
        </div>
    </div>
</div>

<!--Many templates-->
<script type="text/template" id="th_subjects">
    <ul class="nav">
        <li>
            <a>阳光提高班</a>
        </li>
        <%
        for(var i=0 ; i < target.length ; i++){
        subject = target.at(i)
        %>
        <li class="<% if(currentSubjectId == subject.get('id')){ %>active<% } %>">
            <a href="#subject/<%=subject.get('id')%>"><%= subject.get('name') %></a>
        </li>
        <% } %>
    </ul>
    <ul class="nav pull-right">
        <li>
            <div class="btn" onclick="Interfaces.sync()">同步数据</div>
        </li>
    </ul>
</script>

<script type="text/template" id="th_lesson">
    <ul class="nav">
        <li>
            <a><%= target.get('name')%></a>
        </li>
    </ul>
</script>

<script type="text/template" id="tc_subject">
    <% _.each(target.get('monthLessons'),function(monthLesson){ %>
    <h2><%=monthLesson[0].get('month')%>月</h2>

    <div class="row">
        <% _.each(monthLesson,function(lesson){ %>
        <div class="span3">
            <div class="well">
                <h4 style="text-wrap:pre-line"><%=lesson.get("name")%></h4>

                <div class="btn btn-large" onclick="Interfaces.download('<%=lesson.id%>')">下载</div>
                <a class="btn btn-primary btn-large" href="#lesson/<%=lesson.id%>">进入</a>
            </div>
        </div>
        <% }) %>
    </div>
    <% }) %>
</script>

<!-- Stages -->
<script type="text/template" id="tc_lesson">
    <div class="circle_wrap">
        <%
        var meetUnlocked = false
        $.each(target.get("stages").models,function(index,stage){
        var circleClassNum = 0
        var type = parseInt(stage.get('type'))+1
        var imgPath = ""
        var status = StageHelper.get_status(stage)
        if(!meetUnlocked){
        if(status!='EOF'){
                circleClassNum = 1
                imgPath = '0'+type
                meetUnlocked = true
            }else{
                circleClassNum = 0
                imgPath = type
            }
        }else{
            circleClassNum = 2
            imgPath = '00'+type
        }
        imgPath= './img/'+imgPath+'.png'
        Log.i('stage,'+type+","+circleClassNum)
        %>
        <% if (index !=0) {%>
        <img src="./img/line.png" alt="line" class="line"/>
        <% } %>
        <%var choose_circle = 0%>
        <div class="stage_circle circle_<%=circleClassNum%>">
            <% if (circleClassNum != 1) {%>
            <a onclick="viewStage('<%=stage.get('id')%>')"><img src="<%=imgPath%>" alt="circle background"></a>
            <% } else {%>
            <a href="#stage/<%=stage.id%>"><img src="<%=imgPath%>" alt="circle background"></a>
            <% } %>
            <p><%=parseInt(stage.get('seq'))%></p>
        </div>
        <% }) %>
    </div>
</script>

<script type="text/template" id="tc_problem_singlechoice">
    <div class="span10">
        <h3><%=target.get('id')%>
        </h3>

        <p>
            <% userdata = target.get('userdata') %>
            userdata: <%=JSON.stringify(userdata) %>
        </p>

        <p>
            correct answers: <%=target.correct_answers %>
        </p>

        <p>
            body: <%=target.get('body')%>
        </p>

        <p>
            <%
            for(var i =0 ; i < target.get("choices").length; i++) {
            var choice = target.get("choices")[i]
            %>

        <div class="palette palette-clouds">
            <label class="radio">
                <input class="answer"
                       id="<%=choice.id%>"
                       answer="<%= choice.answer%>"
                       type="radio"
                       name="optionsRadios">
                <%= target.get('choices')[i].display_text %>
            </label>
        </div>
        <% } %>
        </p>

        <div class="">
            <div id="grading_result" class="pull-left">
                <% if(userdata.correct==true) { %>
                Right:)
                <% } else if (userdata.correct==false) { %>
                WRONG!!!
                <% } %>
            </div>

            <div class="pull-right">
                <% if(currentMode != MODE.VIEW_ONLY){
                if(userdata.current == 'EOF') { %>
                <a class="btn btn-large" href="#activity/<%=target.get('activity_id')%>">继续</a>
                <% }else{ %>
                <a id="submit_answer" class="btn btn-large  btn-primary"
                   onclick="grading('<%=target.get('id')%>')">提交答案</a>
                <% } %>
                <% } else { %>
                <div>
                    <a class="btn btn-large" href="#activity/<%=target.get('activity_id')%>">继续</a>
                </div>
                <% } %>
            </div>
        </div>
    </div>

</script>


<script type="text/template" id="tc_problem_multichoice">
    <div class="span10">
        <h3><%=target.get('id')%>
            <% if(target.get('userdata')==true){%>(completed)<%}%>
        </h3>

        <p>
            <% userdata = target.get('userdata') %>
            userdata: <%=JSON.stringify(userdata) %>
        </p>

        <p>
            correct answers: <%=target.correct_answers %>
        </p>

        <p>
            body: <%=target.get('body')%>
        </p>

        <p>
            <%
            for(var i =0 ; i < target.get("choices").length; i++) {
            var choice = target.get("choices")[i]
            %>

        <div class="palette palette-clouds">
            <label class="checkbox">
                <input class="answer"
                       id="<%=choice.id%>"
                       answer="<%= choice.answer%>"
                       type="checkbox"
                       name="optionsRadios">
                <%= target.get('choices')[i].display_text %>
            </label>
        </div>
        <% } %>
        </p>

        <div class="">
            <div id="grading_result" class="pull-left">
                <% if(userdata.correct==true) { %>
                Right:)
                <% } else if (userdata.correct==false) { %>
                WRONG!!!
                <% } %>
            </div>
            <div class="pull-right">
                <%=currentMode%>
                <% if(currentMode != MODE.VIEW_ONLY) { %>
                <% if(userdata.current == 'EOF') { %>
                <a class="btn btn-large" href="#activity/<%=target.get('activity_id')%>">继续</a>
                <% }else{ %>
                <a id="submit_answer" class="btn btn-large  btn-primary"
                   onclick="grading('<%=target.get('id')%>')">提交答案</a>
                <% } %>
                <% }else{ %>
                <div>
                    <a class="btn btn-large" href="#activity/<%=target.get('activity_id')%>">继续</a>
                </div>
                <% } %>
            </div>
        </div>
    </div>

</script>


<script type="text/template" id="tc_problem_singlefilling">
    <p><%=target.get("body")%></p>
    <% userdata = target.get('userdata') %>

    <p>userdata: <%=JSON.stringify(userdata)%></p>

    <p><%=JSON.stringify(target)%></p>
    <% if(currentMode != MODE.VIEW_ONLY) { %>

    <% if(userdata.current == 'EOF') { %>
    <a class="btn btn-large" href="#activity/<%=target.get('activity_id')%>">继续</a>
    <% }else{ %>
    <a id="submit_answer" class="btn btn-large  btn-primary"
       onclick="grading('<%=target.get('id')%>')">提交答案</a>
    <% } %>
    <% } else { %>
    <a class="btn btn-large" href="#activity/<%=target.get('activity_id')%>">继续</a>
    <% } %>
</script>

<script type="text/template" id="tc_stages"></script>
<script type="text/template" id="tc_month"></script>
<script type="text/template" id="tc_activity"></script>
<script type="text/template" id="tc_section"></script>
<script type="text/template" id="tc_summary">
    summary
    <%=JSON.stringify(target)%>
    <% if(target.get('next_activity')!=undefined) {%>
    <a class="btn btn-large" href="#activity/<%=target.get('next_activity')%>">跳转继续</a>
    <% }else if(target.get('next_lesson')!=undefined) { %>
    <a class="btn btn-large" href="#lesson/<%=target.get('next_lesson')%>">返回课程</a>
    <% }else{ %>
    <a class="btn btn-large" href="#section/<%=target.get('section_id')%>">继续</a>
    <% } %>
</script>
<script type="text/template" id="tc_video">
    video
    <p><%=JSON.stringify(target)%></p>
    <%
    id = target.get("id")
    %>

    <div>
        <video id="my_video_1" class="video-js vjs-default-skin" controls
               preload="auto" width="640" height="264" poster="my_video_poster.png"
               data-setup="{}">
            <source src="file:///sdcard/Movies/oceans-clip.mp4<" type='video/mp4'>
        </video>
    </div>
    <div class="btn btn-primary" onclick="completeVideo('<%=id%>')">看完啦</div>

</script>

<script type="text/template" id="tf_lesson"></script>
<script type="text/template" id="tf_subject"></script>
<script type="text/template" id="tf_problem_singlechoice">
</script>

</body>
</html>